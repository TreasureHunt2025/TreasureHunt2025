<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="description" content="早稲田大学 所沢キャンパス祭 宝探し企画" />
  <title>マップ | 宝探し企画</title>
  <link rel="stylesheet" href="./css/reset.css" />
  <link rel="stylesheet" href="./css/treasurehunt.css" />
  <meta name="theme-color" content="#155419" />
</head>

<body class="map-page">
  <header class="header">
    <div class="container flex-between">
      <div class="brand">
        <img class="logo-mark" src="./image/treasure_icon_2.png" width="36" height="36" alt="宝探しロゴ">
        <a class="logo" href="./index.html">Treasure&nbsp;Hunt</a>
      </div>
    </div>
  </header>
  <main role="main">
    <div id="map" class="map-canvas" aria-label="所沢周辺の宝探しマップ"></div>
    <aside id="panel" class="panel" aria-hidden="true">
      <div class="panel-header">
        <strong>ヒント一覧</strong>
        <div style="display:flex; gap:.4rem; margin-left:auto;">
          <button class="panel-close" type="button" aria-label="ヒントを閉じる">×</button>
        </div>
      </div>
      <div id="hint-list" class="panel-body"></div>
    </aside>

    <button id="toggle-panel" class="fab" aria-expanded="false" aria-label="ヒントを開く">💡</button>
    <button id="scan-qr" class="fab fab--qr" aria-label="QRコードを読み取る">📷</button>

    <div id="scanner" class="scanner hidden" aria-hidden="true">
      <div class="scanner__topbar">
        <div class="scanner__left">
          <button id="scan-back" class="scanner__btn scanner__btn--back" aria-label="戻る">← 戻る</button>
        </div>
        <div class="scanner__actions">
          <button id="scan-torch" class="scanner__btn" aria-label="ライト切替">🔦</button>
          <button id="scan-switch" class="scanner__btn" aria-label="カメラ切替">🔁</button>
        </div>
      </div>

      <div class="scanner__viewport">
        <video id="qrVideo" playsinline muted></video>
        <canvas id="qrCanvas" class="hidden"></canvas>
        <div class="scanner__frame"></div>
      </div>

      <div id="scan-status" class="scanner__status">カメラ起動中…</div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <small>2025 所沢キャンパス祭 宝探し企画</small>
    </div>
  </footer>

  <template id="map-config" data-geojson="./tokorozawa.geojson" data-initial-zoom="16"
    data-qr-points='[{"id": "qr1", "name": "treasure1", "lat": 35.7877068014553, "lng": 139.3993037267694}, {"id": "qr2", "name": "treasure2", "lat": 35.785353966985085, "lng": 139.39878154731983}, {"id": "qr3", "name": "treasure3", "lat": 35.78864444263647, "lng": 139.39948253818648}, {"id": "qr4", "name": "treasure4", "lat": 35.78769165849726, "lng": 139.39861191131166}, {"id": "qr5", "name": "treasure5", "lat": 35.7895, "lng": 139.4003}, {"id": "qr6", "name": "treasure6", "lat": 35.7869, "lng": 139.4009}]'
    data-qr-hints='[{"id": "qr1", "hint": "treasure1 を探そう"}, {"id": "qr2", "hint": "treasure2 を探そう"}, {"id": "qr3", "hint": "treasure3 を探そう"}, {"id": "qr4", "hint": "treasure4 を探そう"}]'>
  </template>
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js" defer></script>
  <script src="./js/map.js"></script>
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBy_Oh_oRHjntjRW-g48N-oEovSsqClREc&callback=initMap&v=weekly&loading=async"
    defer></script>
</body>

</html>